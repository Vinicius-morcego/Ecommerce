# Imagem do Zookeeper
FROM confluentinc/cp-zookeeper:latest AS zookeeper
ENV ZOOKEEPER_CLIENT_PORT=2181
ENV ZOOKEEPER_TICK_TIME=2000
EXPOSE 2181

# Imagem do Kafka
FROM confluentinc/cp-enterprise-kafka:latest AS kafka
ENV KAFKA_BROKER_ID=1
ENV KAFKA_ZOOKEEPER_CONNECT='172.20.0.10:2181'
ENV KAFKA_LISTENER_SECURITY_PROTOCOL_MAP=PLAINTEXT:PLAINTEXT,PLAINTEXT_HOST:PLAINTEXT
ENV KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://broker:29892,PLAINTEXT_HOST://localhost:9892
ENV KAFKA_METRIC_REPORTERS=io.confluent.metrics.reporter.ConfluentMetricsReporter
ENV KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1
ENV KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS=0
ENV CONFLUENT_METRICS_REPORTER_BOOTSTRAP_SERVERS=broker:29892
ENV CONFLUENT_METRICS_REPORTER_ZOOKEEPER_CONNECT='172.20.0.10:2181'
ENV CONFLUENT_METRICS_REPORTER_TOPIC_REPLICAS=1
ENV CONFLUENT_METRICS_ENABLE='true'
ENV CONFLUENT_METRICS_SUPPORT_CUSTOMER_ID=1
EXPOSE 29892 9892

# Imagem do Schema Registry
FROM confluentinc/cp-schema-registry:latest AS schema-registry
ENV SCHEMA_REGISTRY_HOST_NAME=schema-registry
ENV SCHEMA_REGISTRY_KAFKASTORE_CONNECTION_URL=172.20.0.10:2181
EXPOSE 8081
